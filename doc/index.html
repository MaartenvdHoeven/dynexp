<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DynExp: DynExp Readme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="DynExp.ico"/></td>
  <td id="projectalign">
   <div id="projectname">DynExp
   </div>
   <div id="projectbrief">Highly flexible laboratory automation for dynamically changing experiments.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> Readme </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <b><a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a></b> is an open-source tool for highly flexible laboratory automation for dynamically changing experiments based on modern C++.</p>
<p>Its idea is rather simple: <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> implements hardware and devices typically employed in (physics) labs. It provides access to abstract and generalized instruments, which can use the hardware. In turn, the abstraction of instruments enables to write hardware-agnostic programs to control and automate experiments, so-called modules. This allows for greatest flexibility since the experiment modules do not depend on specific hardware. Instead, instruments can be assigned to modules without any programming at runtime.</p>
<p>-&gt; Installation Quickstart <br  />
 -&gt; <a href="https://jbopp.github.io/dynexp/doc/index.html">Documentation</a> (Status: <img src="https://github.com/jbopp/dynexp/actions/workflows/doxygen-gh-pages.yml/badge.svg" alt="doxygen-gh-pages workflow status" style="pointer-events: none;" class="inline"/>) <br  />
 -&gt; Article published in SoftwareX at <a href="https://doi.org/10.1016/j.softx.2024.101964">DOI</a>. Please cite this article in your publication as follows if you use <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>:</p>
<blockquote class="doxtable">
<p>&zwj;J. M. Bopp, T. Schröder, 'DynExp—Highly flexible laboratory automation for dynamically changing classical and quantum experiments', SoftwareX <b>28</b>, 101964 (2024) </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md1"></a>
Features and core concepts</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Feature list</h2>
<p>Amongst others, <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> offers the following features:</p><ul>
<li>Highly flexible assignment and visualization of relations between different objects at runtime (see below).</li>
<li>Management of object relations, states and exception propagation. Displaying object relationship trees.</li>
<li>Thread managment and synchronization between instrument and module threads and the user interface thread.</li>
<li>Task-based communication between modules and instruments.</li>
<li>Event-based communication between modules and the user interface thread and in between distinct modules.</li>
<li>Saving project configurations as well as object configurations to project files and loading these files.</li>
<li>Data stream manipulation for operating on and with measurement data in real time.</li>
<li>Networking via gRPC to enable sharing instruments across a local network and in between programms written in different programming languages.</li>
<li>Modular architecture and templates for extending <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> easily (see below).</li>
<li>Platform-independent architecture based on Qt.</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Objects</h2>
<p><a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s manages objects of three different types. <em>HardwareAdapters</em> provide access to physical hardware/devices connected to a computer. <em>Instruments</em> make use of (usually one) <em>HardwareAdapter</em> and abstract some of its functionality. E.g. an NIDAQ data acquisition device is managed by a respective <em>HardwareAdapter</em>. An <em>NIDAQAnalogOut</em> instrument provides access to <b>one</b> of its analog outputs. In turn, this hardware-specific instrument uses the NIDAQ <em>HardwareAdapter</em>. Furthermore, it is based on abstract hardware-agnostic <em>AnalogOut</em>, <em>OutputPort</em>, <em>FunctionGenerator</em>, and <em>DataStreamInstrument</em> <em>meta</em> instruments. Meta instruments declare some functionality, which derived hardware-specific instruments have to implement. Each hardware-specific instrument is based on one or more hardware-agnostic meta instruments and runs a task queue in its own thread. Experiments as programs on their own are implemented as <em>Modules</em>. <em>Modules</em> might possess their own user interface and run their own event queue in their respective own thread. <em>Modules</em> control hardware-specific instruments through hardware-agnostic meta instruments by polymorphism (a concept to call methods of derived classes through base class objects). This renders the modules hardware-agnostic themselves providing greatest flexibility. <em>HardwareAdapters</em> can be assigned and reassigned to (multiple) <em>Instruments</em> and <em>Instruments</em> can be assigned and reassigned to (multiple) <em>Modules</em> at runtime without any programming.</p>
<p>Currently supported hardware:</p><ul>
<li>DAQ<ul>
<li>qutools TDC</li>
<li>National Instruments NIDAQmx</li>
<li>Zurich Instruments MFLI</li>
</ul>
</li>
<li>Function generators<ul>
<li>Rohde &amp; Schwarz SMB100B</li>
<li>Rohde &amp; Schwarz SMC100A</li>
<li>Swabian Instruments Pulse Streamer 8/2</li>
</ul>
</li>
<li>Imaging<ul>
<li>Teledyne Photometrics PVCam</li>
</ul>
</li>
<li>Motion Control<ul>
<li>Nenion Leakvalve F3</li>
<li>Physik Instrumente (PI) C-862</li>
<li>SmarAct MCS2</li>
</ul>
</li>
</ul>
<p>Available modules:</p><ul>
<li><em>ArbitraryFunctionFromCSV</em>: Fills a <em>DataStreamInstrument</em> with samples loaded from a CSV file.</li>
<li><em>ImageViewer</em>: Displays images provided by a <em>Camera</em> instrument.</li>
<li><em>InputPortReader</em>: Reads and displays single samples from an analog or digital <em>InputPort</em> instrument.</li>
<li><em>LockinAmplifierControl</em>: Allows to control a <em>LockinAmplifier</em> instrument.</li>
<li><em>OutputPortWriter</em>: Writes single samples to an analog or digital <em>OutputPort</em> instrument.</li>
<li><em>SignalDesigner</em>: Generates (arbitrary) functions and writes respective samples to <em>FunctionGenerator</em> instruments.</li>
<li><em>SignalPlotter</em>: Displays samples from <em>DataStreamInstruments</em>.</li>
<li><em>SpectrumViewer</em>: Displays spectra recorded by <em>Spectrometer</em> instruments.</li>
<li><em>Stage1D</em>: Allows to control a single positioner <em>Stage</em> instrument.</li>
<li><em>StreamManipulator</em>: Reads data from a set of input <em>DataStreamInstruments</em>, performs a (set of) Python-based mathematical operation(s) on the input streams, and writes the result(s) to a set of output <em>DataStreamInstruments</em>.</li>
<li><em>Trajectory1D</em>: Sets the position of a single positioner <em>Stage</em> instrument to values read from a <em>DataStreamInstrument</em>.</li>
<li>Experiments<ul>
<li><em>ODMR</em>: Allows to record ODMR spectra with a <em>LockinAmplifier</em> or <em>DataStreamInstrument</em> by sweeping RF signals generated by a <em>FunctionGenerator</em>.</li>
<li><em>WidefieldMicroscope</em>: Implements a reflected-light, a wide-field, and a confocal microscope using a <em>Camera</em> and multiple <em>Stage</em> instruments. Allows to record photoluminescence (PL) scans. Furthermore, this module provides access to a <em>TimeTagger</em>'s HBT functionality and features for automated characterization of single-photon emitters spread across a sample's surface.</li>
</ul>
</li>
</ul>
<p>Currently supported virtual gRPC network instruments (clients) and modules (servers):</p><ul>
<li>Analog/digital in/out (server + client)</li>
<li>Data streams (server + client)</li>
<li>Spectrometer (client)</li>
<li>Time tagger (server + client)</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Getting started: building DynExp</h1>
<p>After cloning <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s repository (to a path not containing any space character!), run <code>install_dependencies.ps1</code> under Windows or <code>install_dependencies.sh</code> under Linux in the folder <code>src</code> under the topmost folder of this repository to set up the package manager vcpkg and to use vcpkg to download and compile <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s dependencies (like Qt, see below for manual Qt installation). This might take several hours and consume about 90 GB disk space. After successful installation of all required packages with vcpkg, the contents of the folder <code>../vendor/vcpkg/buildtrees</code> may be deleted to free some disk space again.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Basic setup</h2>
<h3><a class="anchor" id="autotoc_md6"></a>
Windows</h3>
<p>Compilation was tested using MSVC build tools version &gt;= 17.10.0 on Windows 10 64-bit. Compile via the Visual Studio user interface opening the folder <code>src/DynExpManager</code> and setting <code>CMakeLists.txt</code> as the startup item. Do not forget to chose the desired build configuration (release, debug etc.).</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Linux</h3>
<p>Compilation was tested using gcc 13 on Ubuntu 22.04.3 LTS 64-bit.</p>
<h4><a class="anchor" id="autotoc_md8"></a>
Installation of gcc 13</h4>
<p>On Ubuntu 22, likely the gcc compiler needs to be upgraded manually to version 13. This can be performed running </p><div class="fragment"><div class="line">sudo add-apt-repository ppa:ubuntu-toolchain-r/test</div>
<div class="line">sudo apt update</div>
<div class="line">sudo apt install gcc-13 g++-13</div>
</div><!-- fragment --> <h4><a class="anchor" id="autotoc_md9"></a>
Configure and compile</h4>
<p>To compile, call </p><div class="fragment"><div class="line">cmake --preset linux-[debug|relwithdebinfo|release]-[default|user] ./DynExpManager</div>
</div><!-- fragment --><p> in the same folder where <code>install_dependencies.sh</code> is located and subsequently run <code>ninja</code> in folder <code>../out/build/linux-[debug|relwithdebinfo|release]-[default|user]</code>.</p>
<h4><a class="anchor" id="autotoc_md10"></a>
Troubleshooting</h4>
<p>If <code>"Fontconfig error: Cannot load default config file"</code> occurs and if <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s font looks strange, set the environment variable: </p><div class="fragment"><div class="line">export FONTCONFIG_PATH=/etc/fonts/</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Manual Qt installation</h2>
<p>If you wish to install Qt manually or to use an already installed Qt version, refer to <a href="https://www.qt.io/download-open-source">https://www.qt.io/download-open-source</a> and follow the instructions given there. Skip installing <code>qtbase</code>, <code>qtserialport</code>, <code>qtcharts</code>, <code>qtdatavis3d</code>, and <code>qtsvg</code> via vcpkg in that case (but make sure that they are available in your manual Qt installation). To skip the automatic installation of Qt libraries with vcpkg, execute the respective <code>install_dependencies.[ps1|sh]</code> script with the <code>-skip-install-qt</code> flag under Windows and with <code>--skip-install-qt</code> under Linux, respectively. Set the cmake variable <code>CMAKE_PREFIX_PATH</code> to the Qt installation directory by renaming the file <code>CMakeUserPresets.json.default</code> to <code>CMakeUserPresets.json</code> and adding the line </p><div class="fragment"><div class="line">&quot;CMAKE_PREFIX_PATH&quot;: &quot;C:/[adjust-path]/Qt/6.4.2/msvc2019_64/&quot;</div>
</div><!-- fragment --><p> to the <code>cacheVariables</code> sections of the different configuration presets in <code>CMakeUserPresets.json</code>. Then, build the specific user configuration preset.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Third-party support</h2>
<p>Set cmake options to compile with third-party libraries (for including respective hardware adapters and instruments) by firstly renaming the file <code>CMakeUserPresets.json.default</code> to <code>CMakeUserPresets.json</code>. Secondly, activate the thid-party components by adding lines like </p><div class="fragment"><div class="line">&quot;USE_SWABIANPULSESTREAMER&quot;: true</div>
</div><!-- fragment --><p> to the <code>cacheVariables</code> sections of the different configuration presets in <code>CMakeUserPresets.json</code>. Then, build the specific user configuration preset. A list of all available options can be found at the beginning of the main <code>CMakeLists.txt</code> (refer to <code>option</code> declarations).</p>
<p>Alternatively, add command line options like <code>-DUSE_SWABIANPULSESTREAMER=True</code> to the call of cmake.</p>
<p>Do not forget to place the required third-party include and library files into the folders under <code>src/DynExpManager/include</code> and <code>vendor</code>, respectively. Refer to the <code>README.txt</code> files in the subfolders under <code>src/DynExpManager/include</code> for further instructions.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Update libraries DynExp depends on</h2>
<ul>
<li>Run <code>git pull</code> in folder <code>vendor/vcpkg</code> under the topmost folder of this repository</li>
<li>Run <code>.\bootstrap-vcpkg.bat -disableMetrics</code> (Windows) or <code>./bootstrap-vcpkg.sh -disableMetrics</code> (Linux)</li>
<li>Run <code>.\vcpkg upgrade --no-dry-run</code> (Windows) or <code>./vcpkg upgrade --no-dry-run</code> (Linux)</li>
</ul>
<h2><a class="anchor" id="autotoc_md14"></a>
Install Python modules for the embedded interpreter</h2>
<p>Further Python modules can be installed by adding them as a <code>;</code>-separated string to the <code>Python_USER_REQUIRED_MODULES</code> variable in the <code>cacheVariables</code> sections of the different configuration presets in <code>CMakeUserPresets.json</code> like </p><div class="fragment"><div class="line">&quot;Python_USER_REQUIRED_MODULES&quot;: &quot;ModuleA;ModuleB&quot;</div>
</div><!-- fragment --><p> and by reconfiguring the project subsequently running <code>cmake</code>.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Examples</h1>
<p>The folder <code>examples</code> located under the topmost folder of this repository contains example projects, which can be loaded with <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> without any third-party hardware.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Signal designing</h2>
<p>The project <code>SignalDesigning.dynp</code> demonstrates the <em>SignalDesigner</em> and <em>SignalPlotter</em> modules. With the signal designer, arbitrary signals can be designed and written to a data stream instrument. The signal plotter shows the samples stored in the data stream instrument's buffer. Signals designed with the <em>SignalDesigner</em> module can be saved to the project file. <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> will automatically regenerate saved signals after loading the project, even without starting the <em>SignalDesigner</em> module again.</p>
<div class="image">
<img src="SignalDesigning.png" alt=""/>
<div class="caption">
Screenshot of the signal designing example</div></div>
    <h2><a class="anchor" id="autotoc_md17"></a>
Streaming data samples to a positioner stage</h2>
<p>The project <code>SignalToPosition.dynp</code> loads data samples from a CSV file using the <em>ArbitraryFunctionFromCSV</em> module and stores them in a data stream instrument. Then, the <em>Trajectory1D</em> positioning module is used to interpret these samples as positions. The module moves a positioner stage to the positions stored in the data stream instrument's buffer.</p>
<p>To siumlate a positioner stage, the <em>Physik Instrumente (PI) C-862</em> stage is used. This stage in reality communicates over a serial COM port. Due to <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s flexibility and for testing purposes, the stage is instead connected to a TCP socket to track its communication. To open a respective TCP socket the stage can communicate with on the localhost's port 1000, run the unix <code>nc</code> utility in a shell: </p><div class="fragment"><div class="line">sudo nc -l 1000</div>
</div><!-- fragment --><p>Then, load the project file and click the <code>Force Trigger</code> button in the <em>Trajectory1D</em> module. In the shell window running <code>nc</code>, move absolute commands <code>MAxxx</code> to move the positioner along the sinusoidal trajectory loaded from the CSV file will be displayed. The positioner instrument will show warnings since in this simulation, it will never receive the answers it expects from a real device.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Python-based data stream manipulation</h2>
<p>The project <code>StreamManipulation.dynp</code> demonstrates the manipulation of data streams with the Python interpreter embedded by <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>. After opening the project, <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> will display two signal plotter windows. One of them shows the data contained in the input data streams <code>In1</code> and <code>In2</code>. The other plotter shows the output data <code>Out1</code> resulting from a multiplication of both input data streams. The multiplication is performed by the <em>StreamManipulator</em> module. It possesses an arbitrary number of input and output data stream instruments as well as a Python script to perform the data manipulation. In this example, the file <code>stream_multiply.py</code> is loaded from the examples directory. Its <code>on_step</code> function performs the multiplication and writes the resulting data to the output data stream. The function returns an object with the <code>MinNextExecutionDelay</code> and the <code>MaxNextExecutionDelay</code> properties. Together, these properties determine how often the Python script runs. It waits for at least <code>MinNextExecutionDelay</code> until every input data stream received new samples until it runs. It also runs if <code>MaxNextExecutionDelay</code> is exceeded.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Python-based PID controller</h2>
<p>The project <code>PIDController.dynp</code> simulates an object whose temperature is regulated with an attached PID-controlled heater. The object's temperature simulation as well as the PID controller are implemented in Python scripts operating on data stream instruments with two <em>StreamManipulator</em> modules. There are three data stream instruments: the first and second one each contain a single sample indicating the heater's heating power and the temerature setpoint, respectively. The third data stream instrument contains the measured (simulated) temperature over time. On the one hand, a stream manipulator employs the <code>temperature_model.py</code> script to simulate the object's temperature. The temperature changes according to the applied heating power with some latency. On the other hand, another stream manipulator utilizes the <code>pid_controller.py</code> script to determine the heating power according to the temperature setpoint with a PID controller. A <em>SignalDesigner</em> module enables to adjust the temperature setpoint.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Stream data samples across an ethernet (TCP) connection</h2>
<p>Open two instances of <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> and the server project file <code>NetworkStreamServer.dynp</code> in the first and the client project file <code>NetworkStreamClient.dynp</code> in the second <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> instance. Using Linux, the server might need root permissions to open a TCP socket. The server uses the <em>StreamManipulator</em> module with the <code>stream_randomize.py</code> Python file to simulate measurement data. The 'measurement' data is generated by the Python script and written to a data stream instrument. Next, the network data stream instrument server streams the generated samples to the client over a TCP socket using <a href="https://grpc.io/">gRPC</a>. On the client site, a network data stream instrument client receives the data and a <em>SignalPlotter</em> module displays it.</p>
<p>Note that ethernet communication protocols defined with gRPC are independent of a certain programming language. It is possible to write e.g. a Python client to receive data from <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> or to write data from the Python client to the <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> server or the other way round.</p>
<div class="image">
<img src="NetworkStream.png" alt=""/>
<div class="caption">
Screenshot of the network streaming example</div></div>
    <h2><a class="anchor" id="autotoc_md21"></a>
Python-based interoperability with qudi</h2>
<p>For experimental control, <a href="https://github.com/Ulm-IQO/qudi-core">qudi</a> is a widespread Python-based solution. Since <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> comes with an embedded Python interpreter, it can communicate with qudi. The project <code>qudiReadStream.dynp</code> uses a <em>StreamManipulator</em> module with the <code>qudi_read_stream.py</code> Python file to read data samples from a qudi <code>instream</code> module. The Python script connects to qudi (assuming it listening on localhost's port 65200) in the <code>on_init</code> function. Its <code>on_step</code> function reads data samples and populates the data stream instrument connected to the <em>StreamManipulator</em> module. A <em>SignalPlotter</em> module displays the received samples. When stopping the <em>StreamManipulator</em> module, the function <code>on_exit</code> in the Python file is called to close the ethernet connection to qudi.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
Documentation</h1>
<p><a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s <b>documentation</b> can be found <b><a href="https://jbopp.github.io/dynexp/doc/index.html">here</a></b>.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Generate documentation locally</h2>
<p>Install Doxygen using </p><div class="fragment"><div class="line">sudo apt install doxygen graphviz</div>
</div><!-- fragment --><p> and run </p><div class="fragment"><div class="line">doxygen</div>
</div><!-- fragment --><p> in the topmost folder of this repository. Then, the <a href="./doc/html/index.html">documentation main page</a> can be found in <code>./doc/html/index.html</code>.</p>
<h1><a class="anchor" id="autotoc_md24"></a>
Contributing</h1>
<p>Every contribution to <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> is highly welcome. To contribute, please fork this repository, commit your changes to your fork, and open a pull request to merge your changes into <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s main repository. If you have any further questions, do not hesitate to contact <a href="#" onclick="location.href='mai'+'lto:'+'git'+'hu'+'b@j'+'bo'+'pp.'+'de'; return false;">Julian</a>.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Bug reports</h2>
<p>To report bugs, please open an issue that includes details about the steps which have led to undesired behavior as well as hardware details of your system. Always include <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a>'s log file <code>DynExp.html</code>, which is saved to the directory where the <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> executable is located. Preferably, compile <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> with the debug preset, reproduce the bug, and share the debug log file in your issue.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Extending DynExp</h2>
<p>Extending <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> is rather easy when creating new objects (such as instruments or modules) based on predefined template files <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> comes with. To generate source files for a new object, run </p><div class="fragment"><div class="line">bash run-code-template.sh --extract-vars-json [Type] [Name]</div>
</div><!-- fragment --><p> in the folder <code>src/DynExpManager/template</code>. <code>[Type]</code> might be one of the following <code>HardwareAdapter|MetaInstrument|Instrument|Module</code> depending on the object which should be created. <code>[Name]</code> denotes the name of the object to be created. Next, adjust the parameters within the generated <code>[Name].json</code>. This file contains parameters extracted from the respective template. A subsequent call to </p><div class="fragment"><div class="line">bash run-code-template.sh [Type] [Name]</div>
</div><!-- fragment --><p> translates the respective template files into source files using the variables defined in <code>[Name].json</code>. Move the generated source files to the respective directory <code>src/DynExpManager/[HardwareAdapters|MetaInstruments|Instruments|Modules]</code>. The files are added to the project by inserting a line like </p><div class="fragment"><div class="line">target_sources(DynExp PRIVATE &quot;[Name].cpp&quot; &quot;[Name].h&quot; &quot;[Name].ui&quot;)</div>
</div><!-- fragment --><p> into the <code>CMakeLists.txt</code> file contained in the folder where the source files have been moved to. <code>*.ui</code> files do only exist for modules with user interfaces.</p>
<h3><a class="anchor" id="autotoc_md27"></a>
HardwareAdapters, Instruments and Modules only</h3>
<p>As a last step, append the newly created object to the respective libraray vector in <code><a class="el" href="main_8cpp_8in.html" title="This file defines DynExpManager&#39;s main entry point.">main.cpp.in</a></code>. To do so, firstly include the object's header file by adding </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;[HardwareAdapters|Instruments|Modules]/[Name].h&quot;</span></div>
</div><!-- fragment --><p> Then, add the line </p><div class="fragment"><div class="line"><a class="code hl_namespace" href="namespaceDynExp.html">DynExp</a>::[Name],</div>
<div class="ttc" id="anamespaceDynExp_html"><div class="ttname"><a href="namespaceDynExp.html">DynExp</a></div><div class="ttdoc">DynExp's main namespace contains the implementation of DynExp including classes to manage resources (...</div><div class="ttdef"><b>Definition</b> <a href="CircuitDiagram_8h_source.html#l00016">CircuitDiagram.h:17</a></div></div>
</div><!-- fragment --><p> to the type definition of either <code>HardwareAdapterLib</code>, <code>InstrumentLib</code>, or <code>ModuleLib</code> depending on the object's type.</p>
<h3><a class="anchor" id="autotoc_md28"></a>
Updating the template parser</h3>
<p>To update the parameter system <code>code-template</code> from GitHub, run </p><div class="fragment"><div class="line">git subtree pull --prefix src/DynExpManager/template/code-template https://github.com/jbopp/code-template.git DynExpIntegration --squash</div>
</div><!-- fragment --><p> in the repository's root directory.</p>
<h1><a class="anchor" id="autotoc_md29"></a>
Screenshots</h1>
<p>Some further screenshots of different <a class="el" href="namespaceDynExp.html" title="DynExp&#39;s main namespace contains the implementation of DynExp including classes to manage resources (...">DynExp</a> modules illustrate part of the implemented features.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
ODMR and Lock-in Amplifier Control modules</h2>
<p><img src="ODMR.png" alt="" class="inline" title="Screenshot of DynExp's ODMR and Lock-in Amplifier Control modules"/>    </p>
<h2><a class="anchor" id="autotoc_md31"></a>
1D Positioner, Spectrum Viewer, and Image Viewer modules</h2>
<p><img src="ImageViewer.png" alt="" class="inline" title="Screenshot of DynExp's 1D Positioner, Spectrum Viewer, and Image Viewer modules"/>    </p>
<h2><a class="anchor" id="autotoc_md32"></a>
Widefield Microscope module</h2>
<p><img src="WidefieldMicroscope.png" alt="" class="inline" title="Screenshot of DynExp's Widefield Microscope module"/>     </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
